<!-- User Listings Page, see listed items -->
{% extends 'base_user.html' %}
{% block content %}
<body class="container-fluid bg-light">

    <div class="row vh-100">
        <!-- Sidebar -->
        <div class="col-md-3 col-lg-2 bg-white shadow-sm p-4">
            <div class="d-grid gap-2">
                <form action="{{ url_for('my_listings') }}" method="post">
                    {{ form.hidden_tag() }}

                    <div>{{ form.info(class="btn btn-outline-secondary custom-button") }}</div>
                    <div>{{ form.my_listings(class="btn btn-outline-secondary custom-button") }}</div>
                    <div>{{ form.watchlist(class="btn btn-outline-secondary custom-button") }}</div>
                    <div>{{ form.notifications(class="btn btn-outline-secondary custom-button") }}</div>
                    <div>{{ form.logout(class="btn btn-outline-secondary custom-button") }}</div>
                </form>
            </div>
        </div>

        <!-- Content Area -->
        <div class="col-md-9 col-lg-10 p-5">
            <h2 class="mb-4">My Listings</h2>
        {% if items %}
            <div class="row">
                {% for item in items %}
                    <div class="col-md-4">
                        <div class="card mb-4 shadow-sm">
                            <img src="{{ item.get_image_url() }}" class="card-img-top" alt="{{ item.item_name }}">
                            <div class="card-body">
                                <h5 class="card-title">{{ item.item_name }}</h5>
                                <p class="card-text">{{ item.description[:100] }}...</p>
                                <p class="card-text"><strong>Price:</strong> Â£{{ item.minimum_price }}</p>
                                <p class="card-text">
                                    <strong>Time Left:</strong> 
                                    {% if item.time_left.total_seconds() > 0 %}
                                        {{ item.time_left }}
                                    {% else %}
                                        Expired
                                    {% endif %}
                                </p>
                                <a href="{{ url_for('view_item', item_id=item.item_id) }}" class="btn btn-primary">View</a>
                                <a href="{{ url_for('edit_item', item_id=item.item_id) }}" class="btn btn-secondary">Edit</a>
                                <a href="{{ url_for('delete_item', item_id=item.item_id) }}" class="btn btn-danger">Delete</a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No items listed yet.</p>
        {% endif %}
        </div>
    </div>

</body>
{% endblock %}
